import React from 'react';
import { useNavigate } from 'react-router-dom';
import TitleValueDisplay, { TitleValueDisplayRow } from 'components/TitleValueDisplay';
import DoublePaneDisplay from 'components/DoublePaneDisplay';
import Title from 'components/Title';
import Button from 'components/Button';
import ProgressBar, { STATUS_MAPPPING } from 'components/ProgressBar';
import SeverityDisplay from 'components/SeverityDisplay';
import ScoreTag from './ScoreTag';
import SeverityWithCvssDisplay from './SeverityWithCvssDisplay';

import COLORS from 'utils/scss_variables.module.scss';

const Separator = () => <div style={{borderTop: `1px solid ${COLORS["color-grey-light"]}`}}></div>

const ScoreBar = ({score}) => (
    <ProgressBar
        status={STATUS_MAPPPING.IN_PROGRESS.value}
        itemsCompleted={score}
        itemsLeft={10 - score}
        width="130px"
        customeTitle={score}
    />
)

const TabVulnerabilityDetails = ({data}) => {
    const navigate = useNavigate();

    const cvssScore = 7.4;

    return (
        <DoublePaneDisplay
            leftPaneDisplay={() => (
                <>
                    <Title medium>General details</Title>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Name">CVE-2018-3342</TitleValueDisplay>
                        <TitleValueDisplay title="Package name">package</TitleValueDisplay>
                        <TitleValueDisplay title="Package version">1.2.11+deb1</TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Severity"><SeverityWithCvssDisplay severity="HIGH" cvssScore={cvssScore} /></TitleValueDisplay>
                        <TitleValueDisplay title="Scan date">Mar 5th, 2023 11:48:35</TitleValueDisplay>
                        <TitleValueDisplay title="Fix version">1.2.11+deb1</TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Description" withOpen defaultOpen>
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit
                        </TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Links" withOpen defaultOpen>
                            <a href="/test" target="_blank" rel="noopener noreferrer">
                                http://localhost:3000/findings/vulnerabilities/fb7408a4-14e5-4892-be47-a19deba21fb5
                            </a>
                        </TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Reporting scanners">grype</TitleValueDisplay>
                        <TitleValueDisplay title="Source">Runtime</TitleValueDisplay>
                        <TitleValueDisplay title="Exploits"><Button tertiary onClick={() => navigate(0)}>See exploits (4)</Button></TitleValueDisplay>
                    </TitleValueDisplayRow>
                </>  
            )}
            rightPlaneDisplay={() => (
                <>
                    <Title medium>CVSS</Title>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Severity"><SeverityDisplay severity="HIGH" score={cvssScore} /></TitleValueDisplay>
                        <TitleValueDisplay title="Scope">Unchanged</TitleValueDisplay>
                        <TitleValueDisplay title="Vector">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow><Separator /></TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Exploitability score"><ScoreBar score={2.8}/></TitleValueDisplay>
                        <TitleValueDisplay title="Attack vector">Network</TitleValueDisplay>
                        <TitleValueDisplay title="Attack complexity"><ScoreTag score="LOW" /></TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Provileges required">None</TitleValueDisplay>
                        <TitleValueDisplay title="User interaction">Required</TitleValueDisplay>
                        <TitleValueDisplay>{/* empty item for spacing */}</TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow><Separator /></TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Impact score"><ScoreBar score={5.9}/></TitleValueDisplay>
                        <TitleValueDisplay title="Integrity"><ScoreTag score="NONE" /></TitleValueDisplay>
                        <TitleValueDisplay title="Availability"><ScoreTag score="HIGH" /></TitleValueDisplay>
                    </TitleValueDisplayRow>
                    <TitleValueDisplayRow>
                        <TitleValueDisplay title="Confidentiality"><ScoreTag score="HIGH" /></TitleValueDisplay>
                    </TitleValueDisplayRow>
                </>
            )}
        />
    )
}

export default TabVulnerabilityDetails;